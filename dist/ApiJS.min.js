!function(a,b,c,d,e){NameSpace("ApiJS"),Clazz("Api",function(a,b){return{methods:{init:function(c,d){var e;return"undefined"==typeof d?("[object Object]"===Object.prototype.toString.apply(c)&&(d=c,c=null),c||(e=b.create(d),a.setService(e.getName(),e)),a.get(c)):(a.setMeta(c,d),void 0)}}}}),Clazz("Manager",function(a){return{properties:{service:{type:"hash",methods:["get","set","has"]},meta:{type:"hash",methods:["get","set","has"]}},methods:{get:function(b){if(!this.hasService(b)){var c=a.create(b,this.getMeta(b));this.setService(c.getName(),c)}return this.getService(b)},has:function(a){return this.hasService(a)||this.hasMeta(a)}}}}),Clazz("Factory",function(a,b,c){return{constants:{NAME_PATTERN:"Api{UID}"},properties:{uid:{"default":0},meta:{"default":new b(c),methods:["get"]}},methods:{create:function(b,c){"undefined"==typeof c&&(c=b,b=null),b||(b=this.generateName());var d=new a({name:b});return"function"==typeof c&&(c=c.apply(d)),this._meta.process(d,c),d},generateName:function(){return this.clazz.const("NAME_PATTERN").replace("{UID}",++this._uid)}}}}),Clazz("Service",function(a){return{properties:{name:{type:"string",methods:"get"},options:{type:"hash",methods:["get","set","has"]},processors:{type:["hash",{keys:["pre","success","fail","post"],element:"array"}],methods:["get","set","has"]},actions:{type:"hash",methods:["get","set","has"]}},methods:{action:function(b){return new a({options:this.getActionOptions(b),processors:this.getActionProcessors(b)})},getActionOptions:function(a){return this._extend({},this.getOptions()||{},this.getActions(a).options||{})},getActionProcessors:function(a){var b,c=this._extend({},this.getProcessors()||{}),d=this.getActions(a).processors;for(b in d)c[b]||(c[b]=[]),Array.prototype.push.apply(c[b],d[b]);return c},_extend:function(a){for(var b=1,c=arguments.length;c>b;++b)for(var d in arguments[b])a[d]=this._copy(arguments[b][d]);return a},_copy:function(a){var b,c=Object.prototype.toString.apply(a);if("object"!=typeof a)b=a;else if("[object Date]"===c)b=new Date(a.getTime());else if("[object Array]"===c){b=[];for(var d=0,e=a.length;e>d;++d)b[d]=this._copy(a[d])}else if("[object RegExp]"===c)b=new RegExp(a.source);else{b={};for(var f in a)b[f]=this._copy(a[f])}return b}}}}),Clazz("Action",function(a,b){return{properties:{options:{type:"hash",methods:["get","set","has"]},processors:{type:["array",{keys:["pre","success","fail","post"],element:"array"}],methods:["get","set","has"]}},methods:{query:function(c){var d=this;return"undefined"!=typeof c&&d.addOptions(c),a.when().then(function(){return d.process("pre")}).then(function(){return a.when(b.ajax(d.getOptions()))}).then(function(){return d.process("success")}).fail(function(){return d.process("fail")}).fin(function(){return d.process("post")})},process:function(b){return this.hasProcessors(b)?a.all(this.getProcessors(b)):void 0}}}}),NameSpace("ApiJS.MetaProcessors"),Clazz("Actions",function(){return function(a,b){for(var c in b){var d={},e={};for(var f in b[c])("processors"===f?e:d)[f]=b[c][f];a.setActions(c,{options:d,processors:e})}}}),Clazz("Options",function(){return function(a,b){a.setOptions(b)}}),Clazz("Processors",function(){return function(a,b){a.setProcessors(b)}}),NameSpace.end(),function(a,b,c,d){var e=Clazz("Action",[c,d]).create(),f=Clazz("Service",[e]).create(),g=Clazz("Factory",[f,b,{options:Clazz("MetaProcessors.Options").create(),processors:Clazz("MetaProcessors.Processors").create(),actions:Clazz("MetaProcessors.Actions").create()}]).create(),h=Clazz("Manager",[g]).create(),i=Clazz("Manager",[h,g]).create();a.Api=i}(a,b,c,d),NameSpace.end()}(this,Meta,Q,jQuery);
//# sourceMappingURL=dist/ApiJS.min.map