!function(a,b,c,d,e){NameSpace("ApiJS"),Clazz("ApiJS.Api",function(){return{properties:{factory:["object"],service:["hash"]},methods:{service:function(a,b){return"undefined"==typeof b||"[object Array]"===Object.prototype.toString.call(b)?(this.hasService(a)||this.setService(a,Service.create({api:this})),this.getService(a)):(this.getFactory().setServiceClazz(a,b),this)}}}}),Clazz("ApiJS.Factory",function(a){return{properties:{serviceClazz:["object"],actionClazz:["object"]},methods:{createService:function(b,c){return a.Manager.getHandler("ApiJS.Service").process(this.getServiceClazz({name:b}).create(),c)},createAction:function(b,c){return a.Manager.getHandler("ApiJS.Action").process(this.getActionClazz().create({name:b}),c)}}}}),Clazz("ApiJS.Service",function(){return{properties:{api:["object"],name:["string"],baseUrl:["string"],header:["hash"],data:["hash"],param:["hash"],option:["hash"],processors:["hash",{keys:["pre","success","fail","post"]}],actionMeta:["hash"]},methods:{action:function(a){return this.getApi().getFactory().createAction(a,this.getActionMeta(a)).setService(this)}}}}),Clazz("ApiJS.Action",function(a,b){return{properties:{name:["string"],service:["object"],path:["string"],method:["string","GET",{pattern:/^(GET|POST|PUT|DELETE|PATCH)$/}],header:["hash"],data:["hash"],param:["hash"],option:["hash"],processors:["hash",{keys:["pre","success","fail","post"]}]},methods:{query:function(){var c=this;return a.when().then(function(){return c.process("pre")}).then(function(){return c.checkRequest(),a.when(b.ajax(c.getAjaxOptions()))}).then(function(){return c.process("success")}).fail(function(){return c.process("fail")}).fin(function(){return c.process("post")})},process:function(b){if(this.hasAllProcessors(b)){var c,d,e=[],f=this.getAllProcessors(b);for(c=0,d=f.length;d>c;++c)e.push(f[c].call(this));return a.all(e)}},getAllHeader:function(a){var b,c={},d=this.getHeader(),e=this.getService().getHeader();for(b in d)c[b]=d[b];for(b in e)c[b]=e[b];return"undefined"!=typeof a?c[a]:c},hasAllHeader:function(a){return a in this.getAllHeader()},getAllParam:function(a){var b,c={},d=this.getParam(),e=this.getService().getParam();for(b in d)c[b]=d[b];for(b in e)c[b]=e[b];return"undefined"!=typeof a?c[a]:c},hasAllParam:function(a){return a in this.getAllParam()},getAllData:function(a){var b,c={},d=this.getData(),e=this.getService().getData();for(b in d)c[b]=d[b];for(b in e)c[b]=e[b];return"undefined"!=typeof a?c[a]:c},hasAllData:function(a){return a in this.getAllData()},getAllProcessors:function(a){var b={},c=this.getService().getProcessors(),d=this.getProcessors(),e,f,a;for(a in["pre","success","fail","post"]){if(e={},a in c)for(f in c)e[f]=c[f];if(a in d)for(f in d[a])e[f]=d[a][f];for(f in e){b[a]=e;break}}return"undefined"!=typeof a?b[a]:b},hasAllProcessors:function(a){return a in this.getAllProcessors()},getAllOption:function(a){var b,c={},d=this.getOption(),e=this.getService().getOption();for(b in d)c[b]=d[b];for(b in e)c[b]=e[b];return"undefined"!=typeof a?c[a]:c},hasAllOption:function(a){return a in this.getOption()},getAjaxOptions:function(){var a=this.getAllOption();return a.url=this.getUrl(),a.type=this.getMethod(),a.headers=this.getAllHeader(),a.data=this.getAllData(),a.processData=!1,a},getUrl:function(){var a,b=this.getAllParam(),c=[],d="/"+this.getService().getBaseUrl()+"/"+this.getPath();d=d.replace(/\/+/,"/");for(a in b)this.isParamInPath(a)?d=d.replace("{"+a+"}",b[a]):c.push("param="+b[a]);return c=c.join("&"),c&&(-1===d.search("?")?d+="?":"&"!==d[d.length-1]&&(d+="&"),d+=c),d},isParamInPath:function(a){return-1!==this.getPath().search("{"+a+"}")}}}}),b.Manger.setProcessor("Actions",function(a,b){for(var c in b)a.setActionMeta(c,b[c])}),b.Manager.setProcessor("BaseUrl",function(a,b){a.setBaseUrl(b)}),b.Manager.setProcessor("Data",function(a,b){for(var c in b)a.setData(c,b[c])}),b.Manager.setProcessor("Headers",function(a,b){for(var c in b)a.setHeader(c,b[c])}),b.Manager.setProcessor("Method",function(a,b){a.setMethod(b)}),b.Manager.setProcessor("Options",function(a,b){for(var c in b)a.setOption(c,b[c])}),b.Manager.setProcessor("Params",function(a,b){for(var c in b)a.setParam(c,b[c])}),b.Manager.setProcessor("Path",function(a,b){a.setPath(b)}),b.Manager.setProcessor("Processors",function(a,b){for(var c in b)a.setProcessor(c,b[c])}),function(a,b,c,d){var e=Clazz("Action",[c,d]),f=Clazz("Service",[e]),g=Clazz("Factory",[b]),h=Clazz("Api");a.api=h.create({factory:g.create({serviceClazz:f,actionClazz:e})})}(a,b,c,d),NameSpace.end()}(this,Meta,Q,jQuery);
//# sourceMappingURL=dist/ApiJS.min.map